<template name="acuereMetrics">

    <div>
        <div class="pull-right">
            Select Program:
            <select class="metric-select" style="color: black">
                {{#each program in metricPrograms}}
                    <option id="p-{{program}}">{{program}}</option>
                {{/each}}
            </select>
        </div>
        <h4>All Acuere Metrics</h4>
        <div>

        {{#if metricsCount}}
            <table class="table table-hover table-xtra-condensed cursor-default">
            {{#if metricsRed}}
            <thead>
            <tr class="bg-danger">
                <th>
                    Metrics not meeting criteria
                </th>
                <th class="problemRow">Note</th>
            </tr>
            </thead>
            <tbody>
                {{#each metric in metricsRed}}
                <tr>
                    <td>
                        <a class="plainLink" data-toggle="collapse" href="#{{metric._id}}">{{metric.name}}</a>
                        {{#if metric.observationId}}
                            <li class="collapse" id="{{metric._id}}">
                                &nbsp; &nbsp; Last {{obsName metric.observationId}}: {{obsDate metric.observationId}}
                            </li>
                        {{/if}}
                    </td>
                    <td>
                        {{metric.statusReason}}
                    </td>
                </tr>
                {{/each}}
            </tbody>
            {{/if}}

            {{#if metricsYellow}}
                <thead>
                <tr class="bg-warning">
                    <th>
                        Metrics expiring soon
                    </th>
                    <th class="problemRow">Note</th>
                </tr>
                </thead>
                <tbody>
                {{#each metric in metricsYellow}}
                    <tr>
                        <td>
                            <a class="plainLink" data-toggle="collapse" href="#{{metric._id}}">{{metric.name}}</a>
                            {{#if metric.observationId}}
                                <li class="collapse" id="{{metric._id}}">
                                    &nbsp; &nbsp; Last {{obsName metric.observationId}}: {{obsDate metric.observationId}}
                                </li>
                            {{/if}}
                        </td>
                        <td>
                            {{metric.statusReason}}
                        </td>
                    </tr>
            {{/each}}
            </tbody>

            {{/if}}

                {{#if metricsGreen}}
                    <thead>
                    <tr class="bg-success">
                        <th>
                            Metrics fulfilling criteria
                        </th>
                        <th class="problemRow">Note</th>
                    </tr>
                    </thead>
                    <tbody>
                    {{#each metric in metricsGreen}}
                        <tr>
                            <td>
                                <a class="plainLink" data-toggle="collapse" href="#{{metric._id}}">{{metric.name}}</a>
                                {{#if metric.observationId}}
                                    <li class="collapse" id="{{metric._id}}">
                                        &nbsp; &nbsp; Last {{obsName metric.observationId}}: {{obsDate metric.observationId}}
                                    </li>
                                {{/if}}
                            </td>
                            <td>
                                {{metric.statusReason}}
                            </td>
                        </tr>

                    {{/each}}
                    </tbody>
                {{/if}}


                {{#if metricsGrey}}
                    <thead>
                    <tr class="bg-acuere-grey">
                        <th>
                            <a class="plainLink" data-toggle="collapse" href="#greyMetricsTable">
                            View Non-qualifying metrics
                            </a>
                        </th>
                        <th class="problemRow">Note</th>
                    </tr>
                    </thead>
                <tbody id="greyMetricsTable" class="collapse">
                    {{#each metric in metricsGrey}}
                    <tr>
                        <td>
                            <a class="plainLink" data-toggle="collapse" href="#{{metric._id}}">{{metric.name}}</a>
                            {{#if metric.observationId}}
                                <li class="collapse" id="{{metric._id}}">
                                    &nbsp; &nbsp; Last {{obsName metric.observationId}}: {{obsDate metric.observationId}}
                                </li>
                            {{/if}}
                        </td>
                        <td>
                            {{metric.statusReason}}
                        </td>
                    </tr>
                    {{/each}}

                    </tbody>
                {{/if}}
            </table>
        {{/if}}
            <br/>
            <a style="visibility: {{visibility}}" class="aaa-dev-tools" data-toggle="collapse" href="#acuereVomitDiv">Raw data</a>
            <div id="acuereVomitDiv" class="collapse">
                <span>Counts: {{metricsCount}}</span>
                <pre class="pre-scrollable">
                    {{metricsVomit}}
                </pre>
            </div>
        </div>
    </div>

</template>